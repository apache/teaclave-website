"use strict";(globalThis.webpackChunkapache_teaclave_website=globalThis.webpackChunkapache_teaclave_website||[]).push([[3e3],{1184:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var s=n(4041);const i={},r=s.createContext(i);function a(e){const t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:t},e.children)}},9831:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"teaclave-trustzone-sdk/docs/operation-guide-for-integration-with-each-optee-release","title":"Operation Guide for Integration with Each OP-TEE Release","description":"OP-TEE follows a quarterly release cycle, and it is essential to keep the TrustZone SDK","source":"@site/docs/teaclave-trustzone-sdk/docs/operation-guide-for-integration-with-each-optee-release.md","sourceDirName":"teaclave-trustzone-sdk/docs","slug":"/teaclave-trustzone-sdk/docs/operation-guide-for-integration-with-each-optee-release","permalink":"/teaclave-trustzone-sdk/docs/operation-guide-for-integration-with-each-optee-release","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"teaclave-trustzone-sdk_sidebar","previous":{"title":"Debugging OP-TEE TA","permalink":"/trustzone-sdk-docs/debugging-optee-ta.md"}}');var i=n(1085),r=n(1184);const a={slug:void 0},o="Operation Guide for Integration with Each OP-TEE Release",l={},c=[{value:"Steps",id:"steps",level:2},{value:"1. CI Build QEMU Image",id:"1-ci-build-qemu-image",level:3},{value:"2. Download Artifacts and Upload to Nightlies",id:"2-download-artifacts-and-upload-to-nightlies",level:3},{value:"Nightlies Repository Overview",id:"nightlies-repository-overview",level:4},{value:"File Structure",id:"file-structure",level:4},{value:"Image Types",id:"image-types",level:4},{value:"Upload Process",id:"upload-process",level:4},{value:"3. PR to Bump optee-version.txt",id:"3-pr-to-bump-optee-versiontxt",level:3},{value:"4. Build and Publish Dev Docker",id:"4-build-and-publish-dev-docker",level:3}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"operation-guide-for-integration-with-each-op-tee-release",children:"Operation Guide for Integration with Each OP-TEE Release"})}),"\n",(0,i.jsx)(t.p,{children:"OP-TEE follows a quarterly release cycle, and it is essential to keep the TrustZone SDK\nup to date with the latest OP-TEE versions."}),"\n",(0,i.jsx)(t.p,{children:"This guide outlines the steps required to integrate with each new OP-TEE release,\nincluding building QEMU images, uploading artifacts to nightlies, and updating the\ndevelopment environment."}),"\n",(0,i.jsx)(t.h2,{id:"steps",children:"Steps"}),"\n",(0,i.jsx)(t.h3,{id:"1-ci-build-qemu-image",children:"1. CI Build QEMU Image"}),"\n",(0,i.jsxs)(t.p,{children:["The CI will build with ",(0,i.jsx)(t.strong,{children:"the latest OP-TEE tag"}),". The output artifacts are available\non the GitHub Actions page."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"To trigger the build:"})}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Go to Actions \u2192 Build Test Qemu Image \u2192 Run workflow"}),"\n",(0,i.jsx)(t.li,{children:"Select branch: main"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Important:"})," While we build against the upstream OP-TEE repository (not our own\ncodebase), our repository contains ",(0,i.jsx)(t.code,{children:".patch/"})," files that may be applied during the build.\nTherefore, ensure you select the ",(0,i.jsx)(t.code,{children:"main"})," branch to include any necessary patches."]}),"\n",(0,i.jsx)(t.p,{children:"Once the CI workflow completes, the generated artifacts will be accessible on the\nActions page."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Example:"})," ",(0,i.jsx)(t.a,{href:"https://github.com/apache/teaclave-trustzone-sdk/actions/runs/18874982493",children:"https://github.com/apache/teaclave-trustzone-sdk/actions/runs/18874982493"})]}),"\n",(0,i.jsx)(t.h3,{id:"2-download-artifacts-and-upload-to-nightlies",children:"2. Download Artifacts and Upload to Nightlies"}),"\n",(0,i.jsx)(t.p,{children:"This step requires an Apache account. You need to download the CI artifacts and upload\nthem to the nightlies repository."}),"\n",(0,i.jsx)(t.h4,{id:"nightlies-repository-overview",children:"Nightlies Repository Overview"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Location:"})," ",(0,i.jsx)(t.a,{href:"https://nightlies.apache.org/teaclave/teaclave-trustzone-sdk/",children:"https://nightlies.apache.org/teaclave/teaclave-trustzone-sdk/"})]}),"\n",(0,i.jsx)(t.p,{children:"For each OP-TEE release, we maintain a comprehensive set of images across multiple\narchitectures (aarch64, x86_64). These images serve dual purposes:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"CI Infrastructure:"})," Enable automated testing of TAs on QEMUv8 platforms"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Developer Environment:"})," Provide ready-to-use emulation environments for quick\nTA development and testing"]}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"file-structure",children:"File Structure"}),"\n",(0,i.jsx)(t.p,{children:"For each OP-TEE release (e.g., 4.8.0), the following files are generated:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"aarch64-optee-4.8.0-qemuv8-ubuntu-24.04-expand-ta-memory.tar.gz"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"aarch64-optee-4.8.0-qemuv8-ubuntu-24.04.tar.gz"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"x86_64-optee-4.8.0-qemuv8-ubuntu-24.04-expand-ta-memory.tar.gz"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"x86_64-optee-4.8.0-qemuv8-ubuntu-24.04.tar.gz"})}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"image-types",children:"Image Types"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Standard images"}),": By default, our examples use standard images, which are built\non the OP-TEE repo without changes."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Expand-ta-memory images"}),": Used by TAs that need large memory, such as TLS examples.\nThe patch is applied based on the OP-TEE repo codebase. See\n",(0,i.jsx)(t.a,{href:"/trustzone-sdk-docs/expanding-ta-secure-memory-on-qemuv8.md",children:"Expanding TA Secure Memory on QEMUv8"}),"\nfor details."]}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"upload-process",children:"Upload Process"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Download from Action artifacts:"})}),"\n",(0,i.jsxs)(t.p,{children:["Download all four artifacts from the CI Actions page.\nNote: If downloading from GitHub Actions, the file will be in zip format. You should\nrun ",(0,i.jsx)(t.code,{children:"unzip"})," to extract the ",(0,i.jsx)(t.code,{children:"*.tar.gz"})," files."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Upload to nightlies:"})}),"\n",(0,i.jsxs)(t.p,{children:["You need an Apache account. See ",(0,i.jsx)(t.a,{href:"https://teaclave.apache.org/becoming-a-member",children:"Becoming a Member"}),"\nfor more information."]}),"\n",(0,i.jsx)(t.p,{children:"Upload each of the four artifacts using curl. Example command:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'curl -u YOUR_ASF_ID \\\n     -T ./aarch64-optee-4.8.0-qemuv8-ubuntu-24.04.tar.gz \\\n     "https://nightlies.apache.org/teaclave/teaclave-trustzone-sdk/"\n'})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"3-pr-to-bump-optee-versiontxt",children:"3. PR to Bump optee-version.txt"}),"\n",(0,i.jsx)(t.p,{children:"Update the OP-TEE version to enable the environment to download the correct OP-TEE\nimage version."}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Update the version in:\n",(0,i.jsx)(t.a,{href:"https://github.com/apache/teaclave-trustzone-sdk/blob/main/optee-version.txt",children:"https://github.com/apache/teaclave-trustzone-sdk/blob/main/optee-version.txt"})]}),"\n",(0,i.jsx)(t.li,{children:"Create a PR with the version bump"}),"\n",(0,i.jsx)(t.li,{children:"Merge the PR after CI passes"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"4-build-and-publish-dev-docker",children:"4. Build and Publish Dev Docker"}),"\n",(0,i.jsx)(t.p,{children:"After step 3 PR is merged, rebuild the development Docker image."}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Use the build script:\n",(0,i.jsx)(t.a,{href:"https://github.com/apache/teaclave-trustzone-sdk/blob/main/scripts/release/build_dev_docker.sh",children:"https://github.com/apache/teaclave-trustzone-sdk/blob/main/scripts/release/build_dev_docker.sh"})]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:['Make sure it is tagged as "latest" and publish the new image to Docker Hub:\n',(0,i.jsx)(t.a,{href:"https://hub.docker.com/u/teaclave",children:"https://hub.docker.com/u/teaclave"})]}),"\n",(0,i.jsx)(t.p,{children:"This operation requires access to the Teaclave Docker Hub organization. Please\ncontact project maintainers for assistance."}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);